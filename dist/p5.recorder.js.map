{"version":3,"file":"p5.recorder.js","sources":["../node_modules/downloadjs/download.js","../src/p5.recorder.js"],"sourcesContent":["//download.js v4.2, by dandavis; 2008-2016. [MIT] see http://danml.com/download.html for tests/usage\n// v1 landed a FF+Chrome compat way of downloading strings to local un-named files, upgraded to use a hidden frame and optional mime\n// v2 added named files via a[download], msSaveBlob, IE (10+) support, and window.URL support for larger+faster saves than dataURLs\n// v3 added dataURL and Blob Input, bind-toggle arity, and legacy dataURL fallback was improved with force-download mime and base64 support. 3.1 improved safari handling.\n// v4 adds AMD/UMD, commonJS, and plain browser support\n// v4.1 adds url download capability via solo URL argument (same domain/CORS only)\n// v4.2 adds semantic variable names, long (over 2MB) dataURL support, and hidden by default temp anchors\n// https://github.com/rndme/download\n\n(function (root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine([], factory);\n\t} else if (typeof exports === 'object') {\n\t\t// Node. Does not work with strict CommonJS, but\n\t\t// only CommonJS-like environments that support module.exports,\n\t\t// like Node.\n\t\tmodule.exports = factory();\n\t} else {\n\t\t// Browser globals (root is window)\n\t\troot.download = factory();\n  }\n}(this, function () {\n\n\treturn function download(data, strFileName, strMimeType) {\n\n\t\tvar self = window, // this script is only for browsers anyway...\n\t\t\tdefaultMime = \"application/octet-stream\", // this default mime also triggers iframe downloads\n\t\t\tmimeType = strMimeType || defaultMime,\n\t\t\tpayload = data,\n\t\t\turl = !strFileName && !strMimeType && payload,\n\t\t\tanchor = document.createElement(\"a\"),\n\t\t\ttoString = function(a){return String(a);},\n\t\t\tmyBlob = (self.Blob || self.MozBlob || self.WebKitBlob || toString),\n\t\t\tfileName = strFileName || \"download\",\n\t\t\tblob,\n\t\t\treader;\n\t\t\tmyBlob= myBlob.call ? myBlob.bind(self) : Blob ;\n\t  \n\t\tif(String(this)===\"true\"){ //reverse arguments, allowing download.bind(true, \"text/xml\", \"export.xml\") to act as a callback\n\t\t\tpayload=[payload, mimeType];\n\t\t\tmimeType=payload[0];\n\t\t\tpayload=payload[1];\n\t\t}\n\n\n\t\tif(url && url.length< 2048){ // if no filename and no mime, assume a url was passed as the only argument\n\t\t\tfileName = url.split(\"/\").pop().split(\"?\")[0];\n\t\t\tanchor.href = url; // assign href prop to temp anchor\n\t\t  \tif(anchor.href.indexOf(url) !== -1){ // if the browser determines that it's a potentially valid url path:\n        \t\tvar ajax=new XMLHttpRequest();\n        \t\tajax.open( \"GET\", url, true);\n        \t\tajax.responseType = 'blob';\n        \t\tajax.onload= function(e){ \n\t\t\t\t  download(e.target.response, fileName, defaultMime);\n\t\t\t\t};\n        \t\tsetTimeout(function(){ ajax.send();}, 0); // allows setting custom ajax headers using the return:\n\t\t\t    return ajax;\n\t\t\t} // end if valid url?\n\t\t} // end if url?\n\n\n\t\t//go ahead and download dataURLs right away\n\t\tif(/^data:([\\w+-]+\\/[\\w+.-]+)?[,;]/.test(payload)){\n\t\t\n\t\t\tif(payload.length > (1024*1024*1.999) && myBlob !== toString ){\n\t\t\t\tpayload=dataUrlToBlob(payload);\n\t\t\t\tmimeType=payload.type || defaultMime;\n\t\t\t}else{\t\t\t\n\t\t\t\treturn navigator.msSaveBlob ?  // IE10 can't do a[download], only Blobs:\n\t\t\t\t\tnavigator.msSaveBlob(dataUrlToBlob(payload), fileName) :\n\t\t\t\t\tsaver(payload) ; // everyone else can save dataURLs un-processed\n\t\t\t}\n\t\t\t\n\t\t}else{//not data url, is it a string with special needs?\n\t\t\tif(/([\\x80-\\xff])/.test(payload)){\t\t\t  \n\t\t\t\tvar i=0, tempUiArr= new Uint8Array(payload.length), mx=tempUiArr.length;\n\t\t\t\tfor(i;i<mx;++i) tempUiArr[i]= payload.charCodeAt(i);\n\t\t\t \tpayload=new myBlob([tempUiArr], {type: mimeType});\n\t\t\t}\t\t  \n\t\t}\n\t\tblob = payload instanceof myBlob ?\n\t\t\tpayload :\n\t\t\tnew myBlob([payload], {type: mimeType}) ;\n\n\n\t\tfunction dataUrlToBlob(strUrl) {\n\t\t\tvar parts= strUrl.split(/[:;,]/),\n\t\t\ttype= parts[1],\n\t\t\tdecoder= parts[2] == \"base64\" ? atob : decodeURIComponent,\n\t\t\tbinData= decoder( parts.pop() ),\n\t\t\tmx= binData.length,\n\t\t\ti= 0,\n\t\t\tuiArr= new Uint8Array(mx);\n\n\t\t\tfor(i;i<mx;++i) uiArr[i]= binData.charCodeAt(i);\n\n\t\t\treturn new myBlob([uiArr], {type: type});\n\t\t }\n\n\t\tfunction saver(url, winMode){\n\n\t\t\tif ('download' in anchor) { //html5 A[download]\n\t\t\t\tanchor.href = url;\n\t\t\t\tanchor.setAttribute(\"download\", fileName);\n\t\t\t\tanchor.className = \"download-js-link\";\n\t\t\t\tanchor.innerHTML = \"downloading...\";\n\t\t\t\tanchor.style.display = \"none\";\n\t\t\t\tdocument.body.appendChild(anchor);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tanchor.click();\n\t\t\t\t\tdocument.body.removeChild(anchor);\n\t\t\t\t\tif(winMode===true){setTimeout(function(){ self.URL.revokeObjectURL(anchor.href);}, 250 );}\n\t\t\t\t}, 66);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// handle non-a[download] safari as best we can:\n\t\t\tif(/(Version)\\/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari\\//.test(navigator.userAgent)) {\n\t\t\t\tif(/^data:/.test(url))\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t\tif(!window.open(url)){ // popup blocked, offer direct download:\n\t\t\t\t\tif(confirm(\"Displaying New Document\\n\\nUse Save As... to download, then click back to return to this page.\")){ location.href=url; }\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t//do iframe dataURL download (old ch+FF):\n\t\t\tvar f = document.createElement(\"iframe\");\n\t\t\tdocument.body.appendChild(f);\n\n\t\t\tif(!winMode && /^data:/.test(url)){ // force a mime that will download:\n\t\t\t\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t}\n\t\t\tf.src=url;\n\t\t\tsetTimeout(function(){ document.body.removeChild(f); }, 333);\n\n\t\t}//end saver\n\n\n\n\n\t\tif (navigator.msSaveBlob) { // IE10+ : (has Blob, but not a[download] or URL)\n\t\t\treturn navigator.msSaveBlob(blob, fileName);\n\t\t}\n\n\t\tif(self.URL){ // simple fast and modern way using Blob and URL:\n\t\t\tsaver(self.URL.createObjectURL(blob), true);\n\t\t}else{\n\t\t\t// handle non-Blob()+non-URL browsers:\n\t\t\tif(typeof blob === \"string\" || blob.constructor===toString ){\n\t\t\t\ttry{\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \";base64,\"  +  self.btoa(blob)  );\n\t\t\t\t}catch(y){\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \",\" + encodeURIComponent(blob)  );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Blob but not URL support:\n\t\t\treader=new FileReader();\n\t\t\treader.onload=function(e){\n\t\t\t\tsaver(this.result);\n\t\t\t};\n\t\t\treader.readAsDataURL(blob);\n\t\t}\n\t\treturn true;\n\t}; /* end download() */\n}));\n","const _download = require(\"downloadjs\");\r\n\r\nexport default class Recorder {\r\n  #_targetFps;\r\n  #_outputName;\r\n  #_chunks;\r\n  #_recorder;\r\n  #_saveAfterStop;\r\n  #_canvas;\r\n  #_progress;\r\n  #_timer;\r\n\r\n  constructor(output = \"p5.recorder.canvas.webm\", saveAfterStop = true) {\r\n    this.#_targetFps = 60;\r\n    this.#_outputName = output;\r\n    this.#_chunks = [];\r\n    this.#_saveAfterStop = saveAfterStop;\r\n    this.#_timer = {};\r\n  }\r\n\r\n  //doriclaudino\r\n  get #currentBlob() {\r\n    return new Blob(this.#_chunks);\r\n  }\r\n\r\n  get #isRecording() {\r\n    return this.#_recorder && this.#_recorder.state === \"recording\";\r\n  }\r\n\r\n  get #isPaused() {\r\n    return this.#_recorder && this.#_recorder.state === \"paused\";\r\n  }\r\n\r\n  start(canvas = document.querySelector(\"canvas\"), outputName = this.#_outputName, extras = {}) {\r\n    if (this.#isRecording || this.#isPaused) throw new Error(\"Stop first before start again\");\r\n    this.#_canvas = canvas;\r\n    this.#_outputName = outputName;\r\n\r\n    if (!this.#_canvas) throw new Error(\"Can't find the canvas for start recording\");\r\n    if (!this.#_canvas.captureStream) throw new Error(\"Canvas can't support capture Stream\");\r\n\r\n    let stream = this.#_canvas.captureStream(this.#_targetFps);\r\n\r\n    /**\r\n     * https://developers.google.com/web/updates/2016/01/mediarecorder\r\n     * we should check possible codecs\r\n     */\r\n    this.#_recorder = new MediaRecorder(stream);\r\n    this.#_recorder.ondataavailable = this.#_onDataAvailable.bind(this);\r\n\r\n    //default for webm\r\n    this.#_recorder.onstop = this.#_onMediaRecorderStop.bind(this);\r\n    this.#_recorder.onstart = this.#_onMediaRecorderStart.bind(this);\r\n    this.#_recorder.start();\r\n  }\r\n\r\n  #_onDataAvailable(e) {\r\n    if (e.data.size) {\r\n      this.#_chunks.push(e.data);\r\n    }\r\n  }\r\n\r\n  #_onMediaRecorderStart() {\r\n    this.#_timer = {\r\n      start: new Date(),\r\n      end: undefined,\r\n    };\r\n    this.#_progress = 0;\r\n    this.#_chunks = [];\r\n    this.#_chunks.length = 0;\r\n  }\r\n\r\n  #_onMediaRecorderStop() {\r\n    this.#_timer.end = new Date();\r\n    this.#_progress = 100;\r\n    if (this.#_saveAfterStop) this.download();\r\n  }\r\n\r\n  download() {\r\n    _download(this.#currentBlob, this.#_outputName, \"video/webm\");\r\n  }\r\n\r\n  stop() {\r\n    this.#_recorder.stop();\r\n  }\r\n\r\n  get #webMRecordedTime() {\r\n    let date = this.#_timer.end ? this.#_timer.end.getTime() : new Date().getTime();\r\n    return date - this.#_timer.start.getTime();\r\n  }\r\n\r\n  get #webMtotalRecordedFrames() {\r\n    return (this.#webMRecordedTime * this.#_targetFps) / 1000;\r\n  }\r\n\r\n  get status() {\r\n    return {\r\n      state: this.#_recorder.state,\r\n      time: this.#webMRecordedTime,\r\n      frames: this.#webMtotalRecordedFrames,\r\n      progress: this.#_progress,\r\n    };\r\n  }\r\n}\r\n"],"names":["this","Recorder","constructor","output","saveAfterStop","start","canvas","document","querySelector","outputName","Error","captureStream","stream","MediaRecorder","ondataavailable","bind","onstop","onstart","download","_download","stop","status","state","time","frames","progress","Blob","e","data","size","push","Date","end","undefined","length","date","getTime"],"mappings":"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"}